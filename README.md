# 主义主义模拟器 (Ism Simulator)

## 1. 项目愿景

本项目是一个雄心勃勃的模拟器，旨在程序化地生成具有复杂内心世界的非玩家角色（NPC），并观察他们在动态世界中的互动与演化。其核心是基于一个包含超过380种“主义”的哲学框架，为每个NPC赋予独特的意识形态、需求和欲望，从而驱动他们做出不可预测但又合乎逻辑的行为。

我们的目标不是创造一个传统意义上的“游戏”，而是一个“人工社会”的实验室，一个可以涌现出复杂社会现象（如思想传播、集体行动、文化冲突）的数字培养皿。

---

## 2. 核心架构：逻辑与表现分离

为了实现这一宏大目标，项目采用了一种现代化、高性能的架构，将**模拟逻辑**与**视觉表现**完全分离。

![Architecture Diagram](https://i.imgur.com/your-diagram-image-url.png)  _（这是一个占位符，未来可以替换为真实的架构图）_

### 🔹 `world_server` - 世界的大脑 (The Brain)

这是整个模拟的核心，一个用 Python 编写的纯逻辑引擎。

-   **职责**:
    -   管理所有NPC（实体）的状态。
    -   运行所有驱动世界演化的系统（AI决策、需求变化、物理移动等）。
    -   处理资源、经济和环境的变化。
-   **技术核心**: **实体-组件-系统 (Entity-Component-System, ECS)**
    -   **实体 (Entity)**: 一个简单的ID，代表世界中的一个事物（如一个NPC）。
    -   **组件 (Component)**: 纯粹的数据容器，描述实体的某个方面（如 `PositionComponent` 存储位置，`NeedsComponent` 存储需求）。
    -   **系统 (System)**: 纯粹的逻辑，对拥有特定组件的实体进行操作（如 `MovementSystem` 只负责移动，`InteractionSystem` 只负责社交）。
-   **优势**: 这种ECS架构提供了极致的灵活性和可扩展性。想让NPC学会飞？只需添加一个 `FlightComponent` 和 `FlightSystem` 即可，无需改动任何现有代码。这为未来实现生育、学习、组织创建等复杂功能奠定了坚实的基础。

### 🔹 `godot_visualizer` - 世界的脸面 (The Face)

这是一个用 Godot 引擎构建的客户端，作为世界的视觉表现层。

-   **职责**:
    -   通过 WebSocket 连接到 `world_server`。
    -   接收服务器广播的世界状态（如每个NPC的位置、当前动作）。
    -   将数据渲染成玩家可以看到的图形界面。
-   **优势**: 将渲染与逻辑分离，使得两边可以独立开发和优化。逻辑开发者可以专注于复杂的AI算法，而不用担心对游戏帧率的影响；视觉开发者则可以专注于创造美观的画面，而不需要理解背后复杂的模拟机制。

> **重要提示**: 对于最终用户来说，这是一个**单机游戏**。在运行时，"大脑"和"脸面"会在用户的电脑上同时启动并在本地通信，提供无缝的单机体验。

---

## 3. 核心机制：辩证法量化引擎

本项目的灵魂在于其独特的NPC人格生成模型。我们摒弃了传统的、静态的属性分配方法，转而采用一个基于**黑格尔辩证法**的动态量化引擎。这使得每个NPC的意识形态（“主义”）不仅仅是一组数值，而是一个充满内在矛盾与演化潜力的动态结构。

### 基因代码 (Gene Code)

每个“主义”都由一个四位数的“基因代码”定义，例如 `3-2-4-1`。这四位数字分别对应NPC世界观的四个基本支柱：

1.  **场域论 (Field Theory)**: 世界观的宏观背景。
2.  **本体论 (Ontology)**: 自我与存在的本质。
3.  **认识论 (Epistemology)**: 认识世界的方式。
4.  **目的论 (Teleology)**: 最终的目标和动机。

### 辩证演化 (Dialectical Progression)

代码中的每个数字（1, 2, 3, 4）代表一个辩证法的核心阶段，并被映射为一组权重，决定了该支柱内部四个基本元素的配比：`[结构/同一, 冲突/差异, 调和/综合, 失败/崩塌]`。

-   **状态 1: 同一 (Identity)** - `[1.0, 0.0, 0.0, 0.0]`
    -   *哲学含义*: 纯粹的肯定和未分化的统一。一个追求绝对秩序和维持现状的起点。
-   **状态 2: 差异 (Difference)** - `[0.5, 0.5, 0.0, 0.0]`
    -   *哲学含义*: “正题”分裂为“反题”。内心充满了“维持结构”与“挑起冲突”的根本性矛盾。
-   **状态 3: 调和 (Synthesis)** - `[0.25, 0.25, 0.5, 0.0]`
    -   *哲学含义*: “合题”的出现。试图将内在的对立统一于一个更高阶的、以“调和”为主要动机的结构中。
-   **状态 4: 失败 (Collapse)** - `[0.0, 0.0, 0.0, 1.0]`
    -   *哲学含义*: 调和的努力彻底失败。整个系统崩塌，其本质由“失败”和“无序”本身来驱动。

### 示例：生成 `3-2-4-1` 的人格

-   **场域论 = 3 (调和)**: `[0.25, 0.25, 0.5, 0.0]` - 他认为世界是一个试图调和结构与冲突的矛盾场域。
-   **本体论 = 2 (差异)**: `[0.5, 0.5, 0.0, 0.0]` - 他认为“自我”是在两种对立的本质中不断斗争的。
-   **认识论 = 4 (失败)**: `[0.0, 0.0, 0.0, 1.0]` - 他认为所有认识世界的尝试最终都会失败。
-   **目的论 = 1 (同一)**: `[1.0, 0.0, 0.0, 0.0]` - 尽管内心和认知充满矛盾，他最终的目标却是维持一个绝对、单一的结构。

这个模型使得NPC的行为（例如，一个目的论为 `2` 的NPC会同时表现出建设和破坏的行为）充满了深刻的、可解释的内在冲突，为涌现出真实而复杂的社会动态提供了坚实的基础。

---

## 4. 如何运行

### 依赖安装
在启动前，请确保已安装Python的 `websockets`, `pandas` 和 `openpyxl` 库：
```bash
pip install websockets pandas openpyxl
```

### 步骤
1.  **生成主义数据 (如果不存在)**
    如果 `isms_final.json` 文件不存在或需要更新，首先运行数据解析器：
    ```bash
    python excel_parser.py
    ```
    这将读取 `主义主义/59号-哲学意识形态填空.xlsx` 文件，并通过量化引擎生成最新的 `isms_final.json`。

2.  **启动世界服务器 (大脑)**
    在项目根目录下打开一个终端，运行：
    ```bash
    python -u world_server/server.py
    ```
    您应该会看到服务器启动、加载数据并开始监听 `ws://localhost:8765` 的日志。

3.  **启动Godot可视化工具 (脸面)**
    -   使用Godot游戏引擎打开 `godot_visualizer` 目录下的项目。
    -   运行Godot项目。它将自动尝试连接到本地运行的服务器。

4.  **观察！**
    如果一切顺利，您将在Godot窗口中看到NPC们开始根据其内在逻辑移动、互动和生活。

---

## 5. 项目结构

```
.
├── excel_parser.py         # 读取Excel并生成主义数据的核心脚本
├── quantization_engine.py  # 实现辩证法量化算法的引擎
├── isms_final.json         # 由解析器生成的、包含所有主义数据的核心文件
├── godot_visualizer/       # Godot前端项目
└── world_server/           # Python后端模拟器
    ├── ecs/                # ECS框架核心
    │   ├── components/     # 所有组件的定义
    │   └── systems/        # 所有系统的定义
    ├── interactions.json   # 定义了所有可能的社交互动
    ├── locations.json      # 定义了世界中的所有地点
    └── server.py           # 服务器主入口和WebSocket逻辑
```

---

## 6. 未来方向：丰富与细化

当前的辩证法引擎为NPC的“静态”人格奠定了基础。未来的核心任务是让这个人格“活”起来，使其能够在与世界和他人的互动中动态演化。

### 亟待丰富的内容

1.  **主义的动态演化 (Ideological Evolution)**
    -   **当前状态**: NPC的主义在出生时被设定，且终生不变。
    -   **未来计划**: 实现一个“主义演化系统”。当NPC经历重大事件（如个人创伤、目睹社会变革、被他人传教）时，其基因代码可能会发生变异。例如，一个长期处于“冲突”(2)状态的NPC，在经历一次调和失败后，其目的论可能会从 `2` 崩塌为 `4` (失败)。

2.  **集体行动与组织动力学 (Collective Action & Organizational Dynamics)**
    -   **当前状态**: NPC的互动是原子化的（一对一）。
    -   **未来计划**: 引入 `CollectiveActionSystem`。让拥有相似基因代码（特别是目的论）的NPC能够自发形成组织（如学派、公会、反抗军）。这些组织将拥有自己的目标和生命周期，并能与其它组织或个体产生更宏观的互动。

3.  **拉康式欲望系统 (Lacanian Desire System)**
    -   **当前状态**: NPC的需求主要由生理和基本社交驱动。
    -   **未来计划**: 完整实现一个基于拉康精神分析理论的欲望系统。
        -   **想象界 (Imaginary)**: 当一个需求被满足后，产生永不满足的、不断升级的欲望链条。
        -   **象征界 (Symbolic)**: NPC的行为受到社会承认/拒绝（“大他者”的凝视）的深刻影响，从而产生对声望、地位或认可的追求。
        -   **实在界 (Real)**: 由创伤性事件驱动的、非理性的、指向系统崩坏的原始冲动。

### 需要细化的方面

1.  **经济与生产链的深化**
    -   **当前状态**: 拥有基本的资源生产和消费。
    -   **未来计划**: 引入更复杂的生产配方和科技树。NPC的“主义”（如一个认识论为 `1` 的“科学独断论”者）可能会影响其科技研发的偏好，解锁特定的高级物品，从而在经济上获得优势。

2.  **环境与地缘的相互作用**
    -   **当前状态**: 地点拥有类型和基本资源。
    -   **未来计划**: 增强地缘的战略意义。某些地点可能具有独特的“意识形态场域”，长期居住于此的NPC会潜移默化地被影响。同时，资源的稀缺或富足将成为驱动NPC迁徙、冲突甚至战争的核心动力。

3.  **AI的长期记忆与学习**
    -   **当前状态**: NPC的决策主要基于当前状态。
    -   **未来计划**: 为NPC添加一个 `MemoryComponent`，使其能够记录重要的互动历史和事件。这将使他们能够形成长期关系（如宿敌、挚友），并根据过去的经验调整未来的行为策略，而不是简单地重复相同的决策。

欢迎您一同探索这个世界的无限可能！